# 1、get  /_cluster/health  获取集群健康信息

```shell
get /_cluster/health 
>>response:
{
    "cluster_name": "steppecluster4xx",        #集群名称
    "status": "green",                         #集群状态，有green,yellow,red 三种情况
    "timed_out": false,                        #是否超时，false表示未超时
    "number_of_nodes": 3,                      #当前集群的节点数量
    "number_of_data_nodes": 3,                 #当前集群的数据节点的数量
    "active_primary_shards": 23,               #活动的主分片数量
    "active_shards": 46,                       #总共的分片数量（包括主分片和副本）
    "relocating_shards": 0,                    #正在迁移的分片数量
    "initializing_shards": 0,                  #正在初始化的分片数量
    "unassigned_shards": 0,                    #未分配的分片数量
    "delayed_unassigned_shards": 0,            #延迟未分配的分片数量
    "number_of_pending_tasks": 0,              #等待执行的任务数量
    "number_of_in_flight_fetch": 0,            #正在进行的数据获取请求数量
    "task_max_waiting_in_queue_millis": 0,    #队列中等待的任务最长等待时间（毫秒），0表示没有任务在队列中等待。
    "active_shards_percent_as_number": 100    #活动分片百分比（作为数字），这里是 100，表示所有分片都是活动的。
}
   
```

Elasticsearch集群的状态有以下三种：

1. Green

- （绿色）：表示集群处于正常状态。所有的主分片和副本分片都已经分配，并且集群能够正常处理请求。

1. Yellow

- （黄色）：表示集群处于健康状态，但是某些副本分片尚未分配。这可能是由于节点故障或新加入节点导致的数据迁移尚未完成。集群仍然可以正常处理请求，但是在该状态下，数据冗余性会受到一定的影响。

1. Red

- （红色）：表示集群处于不可用状态。至少一个主分片或副本分片无法正常分配或复制。这可能是由于数据丢失、硬盘故障或者其他严重的问题导致的。在该状态下，集群无法提供预期的功能，部分数据可能不可用。

当集群状态为Green时，表示一切正常；Yellow状态仍然可用，但是需要注意数据冗余性；而Red状态表示有严重的问题需要解决。

补充：

- 在以下情况下，Elasticsearch集群可能执行分片迁移和初始化分片的操作：

1. **节点故障：**当一个节点（包括主节点和数据节点）故障或离线时，集群需要将该节点上的分片重新分配到其他可用节点上。这涉及到分片的迁移过程，将原本在故障节点上的分片副本迁移到其他节点上，并确保数据的复制和可用性。

1. **新节点加入：**当新的节点加入集群时，集群会对其进行初始化操作。这包括创建索引和分片，分配主分片和副本分片到新节点上，并进行数据的复制。

1. **索引新增或变更：**当创建新的索引或更改现有索引的配置时，集群需要重新计算分片的分配和复制策略。例如，在添加新的主分片或增加副本分片数量时，集群需要进行分片的初始化和复制。

1. **集群健康调整：**当集群中的分片失衡或不均匀分布时，Elasticsearch会执行分片迁移操作，以实现负载均衡和优化资源利用。这可能涉及将活动分片从一个节点移动到另一个节点，以使集群尽可能平衡。