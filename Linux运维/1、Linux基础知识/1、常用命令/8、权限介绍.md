# **基本权限：**

## **1.	权限的介绍**

**权限位的含义**

```javascript
[root@localhost ~]# ls -l install.log
-rw-r--r--. 1 root root 24772 1 月 14 18:17 install.log
```

**第 1 位代表文件类型。Linux 不像 Windows 使用扩展名表示文件类型，而是使用权限位的第 1
**

**位表示文件类型。虽然 Linux 文件的种类不像 Windows 中那么多，但是分类也不少，详细情况
**

**可以使用“info ls”命令查看。超哥在这里只讲一些常见的文件类型。
**

```
**- “-”：普通文件。
**
**- “b”：block,块设备文件。这是一种特殊设备文件，存储设备都是这种文件，如分区文件/dev/sda1就是这种文件。
**
**- “c”：char,字符设备文件。这也是特殊设备文件，输入设备一般都是这种文件，如鼠标、键盘等。
**
**- “d”：dir,目录文件。Linux 中一切皆文件，所以目录也是文件的一种。
**
**- “l”：link,软链接文件。
**
**- “p”：pipe,管道符文件。这是一种非常少见的特殊设备文件。
**
**- “s”：socket,套接字文件。这也是一种特殊设备文件，一些服务支持 Socket 访问，就会产生这样的文件。
**
```

- ** 第 2～4 位代表文件所有者的权限。
**

```
**- r：代表 read，是读取权限。
**
**- w：代表 write，是写权限。
**
**- x：代表 execute，是执行权限。
**
```

**如果有字母，则代表拥有对应的权限；如果是“-”，则代表没有对应的权限。
**

- ** 第 5～7 位代表文件所属组的权限，同样拥有“rwx”权限。
**

- ** 第 8～10 位代表其他人的权限，同样拥有“rwx”权限。**

# **2	基本权限命令**

## **修改权限命令：chmod:**

- **命名称：chmod;**

- **英文原意：change file mode bites;(修改文件模式）；**

- **所在路径：/bin/chmod;**

- **执行功能：所有用户；**

- **功能描述：修改为文件的权限模式；**

## **命令格式：**

```javascript
[root@localhost ~]# chmod [选项] 权限模式 文件名
选项：
-R： 递归设置权限，也就是给子目录中的所有文件设定权限
```

- **chmod   u+x,g+x,o+x test  :给test文件的所有者、所属组、以及其他用户都赋予了可执行的权利；**

```javascript
[root@localhost test]# ll
总用量 4
-rw-r--r--. 1 root root 521 7月  21 12:06 test
[root@localhost test]# chmod u+x,g+w,g+x test    //更改权限
[root@localhost test]# ll
总用量 4
-rwxrwxr--. 1 root root 521 7月  21 12:06 test    //更改而完成；
```

- **chmod u=rwx,g=rx,o=---  test:给test 文件的所有者赋予rwx的权利，所属组赋予rx的权利,其他用户无任何权利**

```javascript
[root@localhost test]# chmod  u=rwx,g=rx,o--- test
[root@localhost test]# ll
总用量 4
-rwxr-xr-x. 1 root root 521 7月  21 12:06 test
```

- **chmod 755 test:给test文件的所有者赋予wrx的权利，所属组赋予rx的权利，其他赋予rx的权利；**

```javascript
[root@localhost test]# ll
总用量 4
----------. 1 root root 521 7月  21 12:06 test   
[root@localhost test]# chmod 755 test
[root@localhost test]# ll
总用量 4
-rwxr-xr-x. 1 root root 521 7月  21 12:06 test
```

## **2.2．权限模式
**

chmod 命令的权限模式的格式是“[ugoa][[+-=][perms]]”，也就是“[用户身份][[赋予方式][权限]]”


的格式，我们来解释一下。

### ** 用户身份。
**

- u：代表所有者（user）。


- g：代表所属组（group）。


- o：代表其他人（other）。


- a：代表全部身份（all）。

### ** 赋予方式。
**

- +：加入权限。


- -：减去权限。


- =：设置权限。

### ** 权限。
**

- r：读取权限（read）。


- w：写权限（write）。


- x：执行权限（execute）。

### **2.3．数字权限
**

数字权限的赋予方式是最简单的，但是不如之前的字母权限好记、直观。我们来看看这些数字权


限的含义。


 4：代表“r”权限。


 2：代表“w”权限。


 1：代表“x”权限。

```javascript
[root@xwz ~]# chmod u+x file1 # 属主增加执行
[root@xwz ~]# chmod a=rwx file1 # 所有人等于读写执行
[root@xwz ~]# chmod a=- file1 # 所有人没有权限
[root@xwz ~]# chmod ug=rw,o=r file1 # 属主属组等于读写，其他人只读
[root@xwz ~]# ll file1 # 显示结果
```

## **2.4．常用权限
**

数字权限的赋予方式更加简单，但是需要用户对这几个数字更加熟悉。其实常用权限也并不多，


只有如下几个。


** 644：**




** 755：**

和其他人拥有读和执行权限。


** 777**

会造成一定的安全隐患。

```javascript
[root@xwz ~]# chmod 644 file1
[root@xwz ~]# ll file1
```

# **3	所有者和所属组命令**

## **chown 命令   **

**chown 是修改文件或目录的所有者和所属组的命令**

- **命令名称：chown；**

- **英文原意：change file owner and group。**

- **所在路径：/bin/chown ;**

- **执行权限：所有用户；**

- **功能描述：修改文件和目录的所有者和所属组。**

**1）命令格式**

```javascript
[root@localhost ~]# chown [选项] 所有者:所属组 文件或目录
选项：
-R： 递归设置权限，也就是给子目录中的所有文件设置权限
 [root@localhost test]# chown user1:user1 test   //修改权限
[root@localhost test]# ll
总用量 4
-rwxr-xr-x. 1 user1 user1 521 7月  21 12:06 test
[root@localhost test]# chown root:root test
[root@localhost test]# ll
总用量 4
-rwxr-xr-x. 1 root root 521 7月  21 12:06 test
```

```javascript
[root@xwz ~]# chown centos:hr file1 # 改属主、属组
[root@xwz ~]# chown centos file1 # 只改属主
[root@xwz ~]# chown :hr file1 # 只改属组
```

**普通用户不能修改文件的所有者，哪怕自己是这个文件的所有者也不行。**

**普通用户可以修改所有者是自己的文件的权限。**

## **chgrp 命令**

**chgrp 是修改文件和目录的所属组的命令：**

- **命令名称：chgrp；**

- **英文原意：change group ownership;**

- **所在路径：/bin/chgrp;**

- **执行权限：所有用户；**

- **功能描述：修改文件和目录的所属组；**

```javascript
[root@localhost test]# ll
总用量 4
-rwxr-xr-x. 1 root root 521 7月  21 12:06 test
[root@localhost test]# chgrp user1 test;
[root@localhost test]# ll
总用量 4
-rwxr-xr-x. 1 root user1 521 7月  21 12:06 test
```

# **3	基本权限的作用**

读，写，执行权限对文件和目录的作用是不同的。

- 权限对文件的作用：

- -读（r):对文件有读（r）权限，代表可以读取文件中的数据。既可以对文件执行cat、more、less、head、tail等文件查看命令。

- -写（w):对文件有写（w）权限，代表可以修改文件中的数据。就可以对文件执行vim、echo等修改文件的命令。**注意：对文件有写（w）的权限，是不能对文件进行删除命令的，只能修改文件中的数据。如果想要删除文件必须对其上级目录拥有写（w)的权限；**

- **-执行（x)：对文件有执行（x)权限代表文件拥有了执权限，可以运行。对文件来说，x是最高权限；**

- 权限对目录的作用：

- -读（r):对目录有读（r)的权限，代表可以查看目录的内容，就可以执行ls命令；

- -写（w)：对目录有写（w)的权限，代表可以修改目录下的数据，也就是可以再目录中新建、删除、复制、剪切、子文件或目录。也就是可以对目录执行touch、rm、cp、mv、命令。对目录来说，w是最高权限；

- -执行（x）：如果目录只拥有x权限，目录是不能运行的，必须配合r或者w才能运行；

## **目录的可用权限：**

- 0：任何权限都不赋予；

- 5：基本的目录浏览和进入权限；

- 7：完全权限；

# **5  	umask默认权限**

```javascript
进程 新建文件、目录的默认权限会收到umask的影响，umask表示要减掉得到权限
shell (vim,touch) 新文件或目录权限
vsftpd 新文件或目录权限
samba 新文件或目录权限
useradd 用户HOME
```

```javascript
[root@xwz ~]# type -a umask
umask 是 shell 内嵌
umask 是 /usr/bin/umask
[root@xwz ~]# help umask
umask: umask [-p] [-S] [模式]
 显示或设定文件模式掩码。
 
 设定用户文件创建掩码为 MODE 模式。如果省略了 MODE，则
 打印当前掩码的值。
 
 如果MODE 模式以数字开头，则被当作八进制数解析；否则是一个
  chmod(1) 可接收的符号模式串。
 
 选项：
   -p 如果省略 MDOE 模式，以可重用为输入的格式输入
   -S 以符号形式输出，否则以八进制数格式输出
 
 退出状态：
 返回成功，除非使用了无效的 MODE 模式或者选项。
```

## **示例1:在shell进程中创建文件**

```javascript
[root@xwz ~]# umask # 查看当前用户的umask权限
0022
[root@xwz ~]# umask -S # 查看最终有的权限
u=rwx,g=rx,o=rx
[root@xwz ~]# touch file1
[root@xwz ~]# mkdir dir1
[root@xwz ~]# ll -d dir1/ file1
drwxr-xr-x. 2 root root 6 9月  9 09:29 dir1/
-rw-r--r--. 1 root root 0 9月  9 09:29 file1
```

## **示例2:修改shell umask值(临时)**

```javascript
[root@xwz ~]# umask 0000
[root@xwz ~]# mkdir dir2
[root@xwz ~]# touch file2
[root@xwz ~]# ll -d file2 dir2
drwxrwxrwx. 2 root root 6 9月  9 09:31 dir2
-rw-rw-rw-. 1 root root 0 9月  9 09:31 file
```

## **示例3:修改shell umask值(永久 建议别改)**

```javascript
[root@xwz ~]# vim /etc/profile
--------------
59 if [ $UID -gt 199 ] && [ "`/usr/bin/id -gn`" = "`/usr/bin/id -un`" ];
then
60   umask 002
61 else
62   umask 022
63 fi
---------------
[root@xwz ~]# source /etc/profile # 立即在当前shell中生效
```

## **示例4:通过umask决定新建用户 HOME 目录的权限**

```javascript
[root@xwz ~]# vim /etc/login.defs
-----------------
61 # The permission mask is initialized to this value. If not specified,
62 # the permission mask will be initialized to 022.
63 UMASK      077
------------------
```

## **5.1 查看系统的 umask 权限
**

```javascript
[root@localhost ~]# umask
0022
```

# 用八进制数值显示 umask 权限


```javascript
[root@localhost ~]# umask -S
u=rwx,g=rx,o=rx
```

# 用字母表示文件和目录的初始权限


.2 umask 权限的计算方法


我们需要先了解一下新建文件和目录的默认最大权限。


 对文件来讲，新建文件的

来讲比较危险，不能在新建文件的时候默认赋予，而必须通过用户手工赋予。


 对目录来讲，新建目录的默认最大权限是 777。这是因为对目录而言，执行（x）权限仅仅代表


进入目录，所以即使建立新文件时直接默认赋予，也没有什么危险。





按照官方的标准算法，umask 默认权限需要使用二进制进行逻辑与和逻辑非联合运算才可以得到


正确的新建文件和目录的默认权限。这种方法既不好计算，也不好理解。


我们在这里还是按照权限字母来讲解 umask 权限的计算方法。我们就按照默认的 umask 值是 022


来分别计算一下新建文件和目录的默认权限吧。


 文件的默认权限最大只能是 666，而 umask 的值是 022


“-rw-rw-rw-”减去 “-----w--w-”等于“-rw-r--r—”




 目录的默认权限最大可以是 777，而 umask 的值是 022


“drwxrwxrwx”减去“d----w--w-”等于“drwx-r-xr-x”


注意：umask 默认权限的计算 绝不是数字直接相减。


例如 umask 是 033 呢？


 文件的默认权限最大只能是 666，而 umask 的值是 033


“-rw-rw-rw-”减去“-----wx-wx”等于“-rw-r--r—”