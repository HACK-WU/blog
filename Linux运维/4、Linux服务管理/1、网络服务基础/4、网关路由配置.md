# **1、网关和路由总结**

# **• 路由：**

➢不同网段数据转发

➢路由选择

- **网关**：

➢不同网段数据转发

➢路由选择

➢默认路由

➢NAT转换

# **2、网关和路由设置**

# ****

## **1)route -n 查看系统中的路由表信息**

```javascript
[root@bogon network-scripts]# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags  Metric  Ref    Use  Iface
192.168.1.0     0.0.0.0         255.255.255.0   U      0       0        0  eth0
169.254.0.0     0.0.0.0         255.255.0.0     U      1002    0        0  eth0
0.0.0.0         192.168.1.1     0.0.0.0         UG     0       0        0  eth0
#目标地址        #网关            #子网掩码      #标记                       #网卡名
```

## ****

## **2）临时网关：**



添加：route add default gw ip

```javascript
[root@bogon network-scripts]# route add default gw ip 192.168.1.1
```

删除：route del default gw ip

```javascript
[root@bogon network-scripts]# route del default gw ip 192.168.1.1
```

永久网关：

```javascript
vi   /etc/sysconfig/network-scripts/ifcfg-eth0
```

## 3)添加/删除一个目标网段

```
route add -net 192.168.23.0/24    dev eth0    #添加一个目标网段
route del -net 192.168.23.0/24    dev eth0    #删除一个目标网段
```

# 一、路由表

思考：

- 什么是交换什么是路由，什么是路由表？

- 1.交换是指同网络访问（两台机器连在同一个交换机上，配置同网段的不同就可以直接通迅）

- 2.路由就是跨网络访问（路径选择）

- 3.路由表是记录路由信息的表，在Liux中首先是一张可见的，可更改的表，它的作用就是当数据包发到Liux的时候，系统（或者说内核）就根据这张表中定义好的信息来决定这个数据包接下来该怎么走

## 2.读懂路由信息

**讨论1：**

**按上面的路由表来看，如果我ping一个公网IP(如ping14.200.151.38),应该怎么走？**

- 1)先看目标ip是否为本地ip,如果是，则直接访问本地；如果不是，则找路由表[是否有你访问的网段，

- 2)如果路由表有则从这个路由条目后面指定的网卡出去；如果路由表里没有你访问的网段，则会找默认路由(也就是网关)。

- 3)如果网关也没有的话，则会报错网络不可达。

connect:Network is unreachable

**讨论2**

按上面的路由表来看，如果我ping一个局域网IP为10.1.1.10，会怎么走？

- ping10.1.1.16不会走网关，而是走本地路由从eth8网卡出去（因为路由表里有10.1.1.0/24的路由）。

**讨论3：**

如何加网关和刚除网关，加网关有什么要求？

```
route add default  gw X.X.X.X		临时加网关，马上生效
route del default gw x.X.x.x		临时删网关，马上生效
永久增加网关：
vim /etc/sysconfig/network-scripts/ifcfg-ethe	GATEWAY=X.X.X.X
或者
vim /etc/rc.local	操作系统开机最后读取的一个文件
route add default gw xxxxx
```

**注意事项：**

1.加网关只能加你已经有的路由网段里的一个IP才行（此IP不一定存在）

2.加网关可以不用指定子网掩码（因为是已有的一个网段的1p,所以掩码已经确认了）