# **1、本地用户权限控制：****（默认根目录就是系统的根目录，可以随意切换目录）****
**

```javascript
local_enable=YES 		#是否启用本地系统用户
local_umask=022 		#本地用户所上传文件的权限掩码
local_root=/data/local	#设置本地用户的 FTP 根目录
chroot_local_user=YES 	#是否将用户禁锢在主目录
allow_writeable_chroot=YES	#
local_max_rate=0 		#限制最大传输速率
ftpd_banner=Welcome to blah FTP service #用户登录时显示的欢迎信息
```

- **给本地用户hack赋权，这样hack就可以登录了，没有赋权无法登录**

```javascript
setfacl -m u:hack:rwx /data/local
```

这样hack用户，可以在/data/local目录中，进行增删改操作了。

# **2、实验 需求与 流程： ：
**

## **1）服务端需要创建用户并设置 密码( 所创建的用户，不需要登录操作系统 ，仅用来登录VSFTP )
**

```javascript
useradd -s /sbin/nologin username
```

- 创建两个ftp用户：

```javascript
[root@localhost ~]# useradd -s /sbin/nologin   lisi
[root@localhost ~]# useradd -s /sbin/nologin   zhangsan
```

## **2） 将所有用户禁锢在自己的家目录下
**

注：默认没有禁锢用户时，客户端登录后可以随意切换目录，查看文件所在位置和文件名

```javascript
chroot_local_user=YES
```

#开启用户家目录限制，限制所有用户不能随便切换目录

## **3）将部分用户禁锢在自己的家目录下 将部分用户禁锢在自己的家目录下
**

```javascript
chroot_list_enable=YES                
```

#开启白名单功能，允许白名单中的用户随意切换目录


```javascript
chroot_list_file=/etc/vsftpd/chroot_list
```

#白名单文件所在位置

- 创建白名单文件

```javascript
cd /etc/vsftpd/
vi /chroot_list
    zhangsan
```




## **4） 配置文件 ：/etc/vsftpd/ ftpusers
**

所有写入此文件内的用户名都不允许登录ftp，立刻生效。

```javascript
[root@localhost vsftpd]# vi ftpusers 
# Users that are not allowed to login via ftp
root                      #限制root用户登录
bin
daemon
adm
lp
sync
shutdown
halt
mail
news
```




## **5）修改被动模式数据传输使用端口 修改被动模式数据传输使用端口
**

```javascript
pasv_enable=YES                 #开启被动模式                  
pasv_min_port=30000	     #端口的起始点
pasv_max_port=35000	     #端口的结束点
```