# **1、NFS 服务器的配置******

  NFS 服务器的配置相对比较简单，只需要在相应的配置文件中进行设置，然后启动 NFS 服务器即可。

NFS 服务的配置文件为 /etc/exports，这个文件是 NFS 的主要配置文件，不过系统并没有默认值，所以这个文件不一定会存在，可能要使用 vim 手动建立，然后在文件里面写入配置内容。

**/etc/exports 文件内容格式：**

```javascript
共享目录 客户端 1（访问权限,用户映射,其他） 客户端 2（访问权限,用户映射,其他）
```

**a. 共享目录**

**b. 客户端**

**客户端常用的指定方式：**

```javascript
指定 ip 地址的主机：192.168.0.200
指定子网中的所有主机：192.168.88.0
指定域名的主机：www.atguigu.com
指定域中的所有主机：*.atguigu.com
所有主机：*
```

**c. 设置输出目录的访问权限、用户映射等。**

**访问权限选项：**

```javascript
设置输出目录只读：ro
设置输出目录读写：rw
```

**用户 映射 选项**

```javascript
root_squash：      将 root 用户的访问映射为匿名（nfsnobody）用户 uid 和 gid；（默认生效）
no_root_squash：   保留管理员权限，以服务器管理员的权限管理；
all_squash：       将远程访问的用户及所属组都映射为指定 uid、gid 的匿名用户；
anonuid=xxx：      将远程访问的所有用户都映射为指定 uid 的匿名用户；
anongid=xxx：      将远程访问的所有用户组都映射为指定 gid 匿名组账户；
```

**其它选项 ：**

```javascript
sync： 将数据同步写入内存缓冲区与磁盘中，效率低，但可以保证数据的一致性（同步）；
async：将数据先保存在内存缓冲区中，必要时才写入磁盘（异步）；
```

# **2、NFS服务器的启动与停止**

## **1）启动 NFS 服务器**

为了使 NFS 服务器能正常工作，需要启动 rpcbind 和 nfs 两个服务，并且 rpcbind 一定要先于 nfs 启动。

```javascript
# service rpcbind start
# service nfs start
```

## **2）查询 NFS 服务器状态**

```javascript
# service rpcbind status
# service nfs status
```

## **3）停止 NFS 服务器**

要停止 NFS 运行时，需要先停止 nfs 服务再停止 rpcbind 服务，对于系统中有其他服务(如 NIS)需要使用时，不需要

停止 rpcbind 服务

```javascript
# service nfs stop
# service rpcbind stop
```

## **4）设置 NFS 服务器的自动启动状态**

设置 rpcbind 和 nfs 服务在系统运行级别 2345 自动启动。

```javascript
# chkconfig --level 2345 rpcbind on
# chkconfig --level 2345 nfs on
```

## **5）查看 RPC 服务器开启了哪些端口**

```javascript
rpcinfo –p localhost
```