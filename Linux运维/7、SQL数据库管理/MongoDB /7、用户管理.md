**用户管理**

# 1、注意事项

**验证库:**

对于管理员用户,必须在admin下创建.

- 1. 建用户时,use到的库,就是此用户的验证库

- 2. 登录时,必须明确指定验证库才能登录

- 3. 通常,管理员用的验证库是admin,普通用户的验证库一般是所管理的库设置为验证库

- 4. 如果直接登录到数据库,不进行use,默认的验证库是test,不是我们生产建议的.

- 5. 从3.6 版本开始，不添加bindIp参数，默认不让远程登录，只能本地管理员登录。

# 2、用户管理

## 1）用户创建语法

```
use admin
db.createUser
{
 user: "<name>",
 pwd: "<cleartext password>",
 roles: [
   { role: "<role>",
  db: "<database>" } | "<role>",
 ...
 ]
}
基本语法说明：
user:用户名
pwd:密码
roles:
 role:角色名
 db:作用对象
role：root, readWrite,read 
验证数据库：
mongo -u eagle -p 123 10.0.0.53/eagle
```

## 2）创建超级管理员

```
创建超级管理员：管理所有数据库（必须use admin再去创建）
$ mongo
use admin
db.createUser(
{
 user: "root",
 pwd: "root123",
 roles: [ { role: "root", db: "admin" } ]
}
)
```

## 3）验证用户

```
db.auth('root','root123') 
```

## 4）配置文件开启用户认证

```
security:
authorization: enabled
```

## 5）登录验证

```
mongo -uroot -proot123 admin
mongo -uroot -proot123  10.0.0.53/admin
或者
mongo
use admin
db.auth('root','root123')
```

## 6）登录验证

```
mongo -uroot -proot123 admin
mongo -uroot -proot123  10.0.0.53/admin
或者
mongo
use admin
db.auth('root','root123')
```

## 7）查看用户

```
use admin
db.system.users.find().pretty()
```

## 8）删除用户

```
删除用户
db.createUser({user: "app02",pwd: "app02",roles: [ { role: "readWrite" , db:
"eagle" } ]})
mongo -uroot -proot123 10.0.0.53/admin
use eagle
db.dropUser("app02")
```

## 9）用户角色

- 数据库用户角色：read、readWrite;

- 所有数据库用户角色：readAnyDatabase、readWriteAnyDatabase、

- userAdminAnyDatabase、dbAdminAnyDatabase

- 数据库管理角色：dbAdmin、dbOwner、userAdmin；

- 集群管理角色：clusterAdmin、clusterManager、clusterMonitor、hostManager；

- 备份恢复角色：backup、restore；

- 超级用户角色：root

- 内部角色：system