# 1、软件安装

```
[root@localhost ~]# yum install epel-release.noarch -y
[root@localhost ~]# yum install redis -y
```

# 2、相关文件

```
[root@localhost ~]# rpm -ql redis
/etc/redis.conf # 主配置文件
/usr/bin/redis-benchmark # redis性能检测工具
/usr/bin/redis-check-aof # AOF文件修复工具
/usr/bin/redis-check-rdb # 文件检查工具
/usr/bin/redis-cli # redis客户端
/usr/bin/redis-server # redis服务端
/usr/lib/systemd/system/redis.service # 守护进程
/var/lib/redis # redis数据目录
/var/log/redis # redis日志文件
```

# 3、配置文件介绍

```
[root@node1 ~]# cat /etc/redis.conf | grep -Ev "^$|^#"
==================================基础配置
=============================================
bind 127.0.0.1 # 绑定IP地址
protected-mode yes
port 6379 # 监听端口
tcp-backlog 511
timeout 0 # 设置客户端连接超时时间
tcp-keepalive 300 # 检测客户端是否健康的周期时间
daemonize yes # 是否以守护进程方式启动
supervised no
pidfile /var/run/redis_6379.pid # PID文件
loglevel notice # 日志等级
logfile /var/log/redis/redis.log # 日志文件
databases 16 # 设置数据库的数目
==================================RDB触发条件
===========================================
save 900 1
save 300 10
save 60 10000
stop-writes-on-bgsave-error yes # 当启用了RDB且最后一次后台保存数据失败，Redis是否
停止接收数据
rdbcompression yes # 对于存储到磁盘中的快照，可以设置是否进行压缩存储
rdbchecksum yes # 在存储快照后，我们还可以让redis使用CRC64算法来进行数据校验
dbfilename dump.rdb # 设置快照的文件名
dir /var/lib/redis # 设置快照文件的存放路径
==================================主从复制
=============================================
slave-serve-stale-data yes
slave-read-only yes # 配置Redis的Slave实例是否接受写操作
repl-diskless-sync no # 主从数据复制是否使用无硬盘复制功能
repl-diskless-sync-delay 5 # 等待时间
repl-disable-tcp-nodelay no # 同步之后是否禁用从站上的TCP_NODELAY
slave-priority 100
==================================AOF相关配置
=============================================
appendonly no # 默认redis使用的是rdb方式持久化
appendfilename "appendonly.aof" # 文件名
appendfsync everysec # aof持久化策略的配置
no-appendfsync-on-rewrite no # 在aof重写或者写入rdb文件的时候，不执行持久化策略
auto-aof-rewrite-percentage 100 # 当目前aof文件大小超过上一次重写的aof文件大小的百分
                                #之多少进行重写
auto-aof-rewrite-min-size 64mb # 设置允许重写的最小aof文件大小
aof-load-truncated yes # 当截断的aof文件被导入的时候，会自动发布一个log给客户端然后
load。
lua-time-limit 5000 # 一个lua脚本执行的最大时间
```

# 4、Redis启动、登录与关闭

## 1）启动时使用命令redis-server，参数是配置文件(可以指定参数配置文件，也可以不指定使其默认加载)

```
[root@localhost ~]# redis-server /etc/redis.conf 
```

## 2）

```
[root@localhost ~]# redis-cli --help
redis-cli 3.2.12
Usage: redis-cli [OPTIONS] [cmd [arg [arg ...]]]
 -h <hostname>   Server hostname (default: 127.0.0.1).
 -p <port>     Server port (default: 6379).
 -s <socket>    Server socket (overrides hostname and port).
 -a <password>   Password to use when connecting to the server.
 -r <repeat>    Execute specified command N times.
 -i <interval>   When -r is used, waits <interval> seconds per command.
          It is possible to specify sub-second times like -i 0.1.
 -n <db>      Database number.
 -x         Read last argument from STDIN.
 -d <delimiter>   Multi-bulk delimiter in for raw formatting (default:
\n).
 -c         Enable cluster mode (follow -ASK and -MOVED
redirections).
[root@localhost ~]# redis-cli -h 127.0.0.1 -p 6379
127.0.0.1:6379>
```

## 3）关闭Redis服务

```
127.0.0.1:6379> SHUTDOWN
not connected>
```