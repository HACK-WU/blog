**批量部署案例**

```shell
[root@kvm-server disk-pool]# cat kvm-mamge.sh
#!/bin/bash
XML_DIR="/etc/libvirt/qemu"
KVM_DIR="/disk-pool/"
add_kvm(){    #创建虚拟机
cat <<eof > kvm.txt
  #VIR_NAME RAM{M}   SIZE{g}
 centos01  1024     2
 centos02  512      3
 centos03  1024     4
 centos04  1024     5
 centos05  1024     6
eof
echo "=================================="
if
 [ ! -e kvm.txt ];then
  echo "The kvm.txt File does not exist,Please create ......"
  exit
fi
#Auto Create machines
if [ ! -s kvm.txt ];then
  echo "The kvm.txt is empty file ,Please Refer Above Content ......"
  exit
fi
while  read line
do
  NAME=`echo $line |grep -v "^#" |awk '{print $1}'`
  RAM=`echo  $line |grep -v "^#" |awk '{print $2}'`
  SIZE=`echo $line |grep -v "^#" |awk '{print $3}'`
  virt-install -name=$NAME --ram $RAM --vcpus=1 \
  --diskpath=/var/lib/libvirt/images/${NAME}.qcow2, \
  size=${SIZE},\
  bus=virtio \
  --accelerate \
  --cdrom /root/CentOS-7-x86_64-Minimal-1708.iso\
  --vnc --vncport=-1 \
  --vnclisten=0.0.0.0 \
  --network bridge=virbr0,\
  model=virtio \
  --noautoconsole
done <kvm.txt
echo "成功创建虚拟机！"
}

clone_kvm(){    #克隆虚拟机
echo "成功克隆虚拟机！"
}

delete_kvm(){    #删除虚拟机
 read -p "Please Enter you want deleted virtual machines :" name
  for i in `echo ${name} |sed 's/ /\n/g'`
  do
 /usr/bin/virsh destroy $i
 /usr/bin/virsh undefine $i ;echo "The $i Virtual machines Deleted
Successfully"
  done
echo "成功删除虚拟机！"
}
echo Usage: $0 "{add_kvm|clone_kvm|delete_kvm|help}"
case $1 in
add_kvm )    add_kvm    ;;
clone_kvm )    clone_kvm    ;;
delete_kvm )    delete_kvm    ;;
* )echo Usage: $0 "{add_kvm|clone_kvm|delete_kvm|help}"    ;;
esac
echo "finished"
```