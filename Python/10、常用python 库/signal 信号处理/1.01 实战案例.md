# 1、进程休眠（使进程进入阻塞状态）

```python
import signal
import os
def singleton(cls):
    instances = {}
    def wrapper(*args, **kwargs):
        if cls not in instances:
            instances[cls] = cls(*args, **kwargs)
        return instances[cls]
    return wrapper
def handler(num, frame):
    print("接收到了信号", num)
# 使用单例模式实现
@singleton
class PauseProcess:
    # 注册信号，注册信号之后才会对接收到的幸好进行处理，执行完此信号之后，程序退出阻塞状态，继续运行
    signal.signal(signal.SIGCONT, handler)
    pid = os.getpid()
    # 暂停程序
    def pause(self):
        print(f"Process paused, pid:[{self.pid}]. Run [kill -SIGCONT {self.pid}] to continue this process.")
        signal.pause()
if __name__ == '__main__':
    print("启动程序")
    PauseProcess().pause()
    print("继续执行")
    PauseProcess().pause()
    print("继续执行")
    PauseProcess().pause()
    print("继续执行")
```

# 2、函数执行超时报错

- **自定义函数版**

```python
import signal
import os
import time
def timeoutFn(func, args=(), kwargs={}, timeout_duration=1, default=None):
    class TimeoutError(Exception):
        pass
    def handler(signum, frame):
        raise TimeoutError()
    # set the timeout handler
    signal.signal(signal.SIGALRM, handler)
    signal.alarm(timeout_duration)
    try:
        result = func(*args, **kwargs)
    except TimeoutError as exc:
        result = default
    finally:
        signal.alarm(0)
        signal.signal(signal.SIGALRM, signal.SIG_DFL)
    return result
def test_demo():
    time.sleep(2)
    return "hello"
print(timeoutFn(test_demo, timeout_duration=3, default=9999))
```

- **装饰器版**

```python
import signal
import os
import time
# 超时装饰器
def timeoutDecorate(timout):
    def timeouteFun(func):
        class TimeoutError(Exception):
            pass
        def handler(signum, frame):
            raise TimeoutError("运行超时")
        def inner(*args, **kwargs):
            signal.signal(signal.SIGALRM, handler)
            signal.alarm(timout)
            res = func(*args, **kwargs)
            return res
        return inner
    return timeouteFun
@timeoutDecorate(timout=3)
def test_demo():
    time.sleep(2)
    return "hello"
print(test_demo())
```