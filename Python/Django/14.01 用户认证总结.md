**auth模块 用户认证**

# 1、auth模块

```python
"""
认证模块 
校验用户是否存在 
保存用户状态 
校验用户是否登陆 
修改密码
...
该模块默认需要用到django默认的auth_user表
django的admin后台管理需要用到该表
如何创建超级用户/管理员	
    python3 manage.py createsuperuser
"""
# 1.校验用户名和密码是否正确
from django.contrib import auth
auth.authenticate(request,username=username,password=password)
"""注意括号内用户名和密码必须都给才行,该方法有一个返回值 用户对象/None"""
# 2.保存用户信息
auth.login(request,user_obj)
"""
内部自动帮你操作django_session表 request.session[key] = user_obj该方法执行完毕之后，
在任意位置都可以通过request.user获取到当前登陆的用户对象
"""
# 3.判断当前用户是否登陆
request.user.is_authenticated()
# 4.校验用户是否登陆装饰器
from django.contrib.auth.decorators import login_required
 1.局部配置
  @login_required(login_url='/login/')
  2.全局配置
  LOGIN_URL = '/login/'
  # 全局省事局部灵活
# 5.验证原密码是否正确
request.user.check_password(old_password)
# 6.修改密码
request.user.set_password(new_password)
request.user.save()
# 7.创建用户
from django.contrib.auth.models import User
User.objects.create()  # 密码不加密 不用
User.objects.create_user()  # 普通用户 经常使用
User.objects.create_superuser()  # 超级用户(邮箱必填)
```

# 2、如何扩展auth_user表

```
# 第一种 利用一对一的表关系
 不推荐使用，不太方便
# 第二种 利用面向对象继承
from django.contrib.auth.models import AbstractUser
class UserInfo(AbstractUser):
  # 扩展auth_user表中没有的字段
"""
一定要去配置文件中配置AUTH_USER_MODEL = '应用名.类名'
1.在没有创建auth_user表的前提下才能替代 如果已经创建了那就换一个库
2.扩展的字段尽量不要与原来的字段冲突
3.之前auth模块所有的功能和方法照样可以使用，知识参考的表由原来的变成了UserInfo
"""
```