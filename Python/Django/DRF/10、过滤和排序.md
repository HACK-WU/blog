# 一、过滤Filtering

对于列表数据可能需要根据字段进行过滤，我们可以通过添加django-fitlter扩展来增强支持。

```python
pip install django-filter
```

在配置文件中增加过滤后端的设置：

```python
#1、在APP中注册
INSTALLED_APPS = [
    ...
    'django_filters',  # 需要注册应用，
]
#2、对drf进行配置
REST_FRAMEWORK = {
    ...
    'DEFAULT_FILTER_BACKENDS': ('django_filters.rest_framework.DjangoFilterBackend',)
}
```

在视图中添加filter_fields属性，指定可以过滤的字段

```python
class StudentListView(ListAPIView):
    queryset = Student.objects.all()
    serializer_class = StudentSerializer
    filter_fields = ('age', 'sex')        
    #指定可以对哪些字段进行过滤。
    #注意不是出现这些字段，就进行过滤。而是这样配置之后，就可以对这些字段的值进行过滤。
    #比如：127.0.0.1:8000/four/students/?sex=1 意思就是查询sex=1的字段。
# 127.0.0.1:8000/four/students/?sex=1
```

# 二、排序

对于列表数据，REST framework提供了

使用方法：

在类视图中设置filter_backends，使用

前端可以传递的ordering参数的可选字段值需要在ordering_fields中指明。

 排序和过滤都共同使用filter_backends属性

示例：

```shell
class StudentListView(ListAPIView):
    queryset = Student.objects.all()
    serializer_class = StudentModelSerializer
    filter_backends = [OrderingFilter]        #排序和过滤都共同使用filter_backends属性
    ordering_fields = ('id', 'age')
# 127.0.0.1:8000/books/?ordering=-age
# -id 表示针对id字段进行倒序排序
# id  表示针对id字段进行升序排序
```

如果需要在过滤以后再次进行排序，则需要两者结合!

```python
from rest_framework.generics import ListAPIView
from students.models import Student
from .serializers import StudentModelSerializer
from django_filters.rest_framework import DjangoFilterBackend
class Student3ListView(ListAPIView):
    queryset = Student.objects.all()
    serializer_class = StudentModelSerializer
    filter_fields = ('age', 'sex')
    # 因为局部配置会覆盖全局配置,所以需要重新把过滤组件核心类再次声明,
    # 否则过滤功能会失效
    filter_backends = [OrderingFilter,DjangoFilterBackend]
    ordering_fields = ('id', 'age')
```